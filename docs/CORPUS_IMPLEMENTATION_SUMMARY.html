<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Corpus Class Implementation Summary ‚Ä¢ reindeer</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Corpus Class Implementation Summary"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">reindeer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.17</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="index.html"><span class="fa fas fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/Tidy_speech_processing.html">Tidy Speech Processing</a></li>
    <li><a class="dropdown-item" href="articles/metadata_management.html">Metadata Management</a></li>
    <li><a class="dropdown-item" href="articles/transcription_workflow.html">Transcription Workflow</a></li>
    <li><a class="dropdown-item" href="articles/simulation-infrastructure.html">Simulation Infrastructure</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/humlab-speech/reindeer"><span class="fa fab fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Corpus Class Implementation Summary</h1>

    </div>

<div id="corpus-class-implementation-summary" class="section level1">

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h2>
<p>This document summarizes the revised corpus S7 class implementation with metadata management and media import capabilities.</p>
</div>
<div class="section level2">
<h2 id="changes-made">Changes Made<a class="anchor" aria-label="anchor" href="#changes-made"></a></h2>
<div class="section level3">
<h3 id="id_1-enhanced-corpus-s7-class-rreindeer-corpusr">1. Enhanced Corpus S7 Class (<code>R/reindeer-corpus.R</code>)<a class="anchor" aria-label="anchor" href="#id_1-enhanced-corpus-s7-class-rreindeer-corpusr"></a></h3>
<div class="section level4">
<h4 id="core-features">Core Features<a class="anchor" aria-label="anchor" href="#core-features"></a></h4>
<ul><li>
<strong>Automatic cache building</strong>: Corpus construction now automatically builds/updates the SQLite cache file</li>
<li>
<strong>Metadata gathering</strong>: Scans <code>.meta_json</code> files at database, session, and bundle levels during construction</li>
<li>
<strong>Flexible construction</strong>: Can be created from either a file path or emuDBhandle object</li>
</ul></div>
<div class="section level4">
<h4 id="constructor-pattern">Constructor Pattern<a class="anchor" aria-label="anchor" href="#constructor-pattern"></a></h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">VISP</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/corpus.html">corpus</a></span><span class="op">(</span><span class="st">"path/to/database_emuDB"</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># or</span></span>
<span><span class="va">VISP</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/corpus.html">corpus</a></span><span class="op">(</span><span class="va">emuDBhandle_object</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="id_2-bundle-list-s7-class-rreindeer-corpusr">2. Bundle List S7 Class (<code>R/reindeer-corpus.R</code>)<a class="anchor" aria-label="anchor" href="#id_2-bundle-list-s7-class-rreindeer-corpusr"></a></h3>
<p>A new S7 class that extends tibble to represent query results with metadata: - Inherits from <code>tbl_df</code> - Requires <code>session</code> and <code>bundle</code> columns - Includes inherited metadata from database/session/bundle levels</p>
</div>
<div class="section level3">
<h3 id="id_3-subsetting-operations">3. Subsetting Operations<a class="anchor" aria-label="anchor" href="#id_3-subsetting-operations"></a></h3>
<div class="section level4">
<h4 id="reading-bundle-metadata-corpusi-j">Reading Bundle Metadata: <code>corpus[i, j]</code>
<a class="anchor" aria-label="anchor" href="#reading-bundle-metadata-corpusi-j"></a></h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specific bundle</span></span>
<span><span class="va">VISP</span><span class="op">[</span><span class="st">"Session1"</span>, <span class="st">"Bundle1"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># All bundles in a session  </span></span>
<span><span class="va">VISP</span><span class="op">[</span><span class="st">"Session1"</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Bundle across sessions (if unique)</span></span>
<span><span class="va">VISP</span><span class="op">[</span>, <span class="st">"Bundle1"</span><span class="op">]</span></span>
<span><span class="co"># or</span></span>
<span><span class="va">VISP</span><span class="op">[</span><span class="st">"Bundle1"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Regex patterns</span></span>
<span><span class="va">VISP</span><span class="op">[</span><span class="st">"Sess.*"</span>, <span class="st">"Bund.*"</span><span class="op">]</span></span></code></pre></div>
<p>Returns a <code>bundle_list</code> object (tibble) with session, bundle, and all metadata columns.</p>
</div>
<div class="section level4">
<h4 id="writing-metadata-corpusi-j---value">Writing Metadata: <code>corpus[i, j] &lt;- value</code>
<a class="anchor" aria-label="anchor" href="#writing-metadata-corpusi-j---value"></a></h4>
<p><strong>Database-level metadata</strong> (all bundles):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">VISP</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Institution <span class="op">=</span> <span class="st">"University"</span>, Project <span class="op">=</span> <span class="st">"Speech"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Session-level metadata</strong>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">VISP</span><span class="op">[</span><span class="st">"Session1"</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Age <span class="op">=</span> <span class="fl">30</span>, Gender <span class="op">=</span> <span class="st">"Female"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Bundle-level metadata</strong>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">VISP</span><span class="op">[</span><span class="st">"Session1"</span>, <span class="st">"Bundle1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Age <span class="op">=</span> <span class="fl">25</span>, Gender <span class="op">=</span> <span class="st">"Male"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Using regex</strong> (updates all matching):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">VISP</span><span class="op">[</span><span class="st">"Sess.*1"</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Condition <span class="op">=</span> <span class="st">"Control"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="id_4-media-import-corpusi-j---file_path">4. Media Import: <code>corpus[i, j] &lt;- file_path</code>
<a class="anchor" aria-label="anchor" href="#id_4-media-import-corpusi-j---file_path"></a></h3>
<div class="section level4">
<h4 id="simple-import">Simple Import<a class="anchor" aria-label="anchor" href="#simple-import"></a></h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import to mediafileExtension (usually "wav")</span></span>
<span><span class="va">VISP</span><span class="op">[</span><span class="st">"Session1"</span>, <span class="st">"Bundle1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"path/to/audio.mp3"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="multi-channel-import-with-track-specification">Multi-channel Import with Track Specification<a class="anchor" aria-label="anchor" href="#multi-channel-import-with-track-specification"></a></h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Explicit channel mapping:</span></span>
<span><span class="co"># - Channel 1 ‚Üí mediafileExtension</span></span>
<span><span class="co"># - Channel 2 ‚Üí .egg file</span></span>
<span><span class="co"># - Channel 3 ‚Üí ignored (NULL)</span></span>
<span><span class="co"># - Channel 4 ‚Üí .flow file</span></span>
<span><span class="va">VISP</span><span class="op">[</span><span class="st">"Session1"</span>, <span class="st">"Bundle1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"path/to/multichannel.mp3"</span>, <span class="st">"egg"</span>, <span class="cn">NULL</span>, <span class="st">"flow"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or with file path at different position:</span></span>
<span><span class="va">VISP</span><span class="op">[</span><span class="st">"Session1"</span>, <span class="st">"Bundle1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"egg"</span>, <span class="st">"path/to/file.mp3"</span>, <span class="cn">NULL</span>, <span class="st">"flow"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Requirements</strong>: - No regex patterns allowed for media import (exact names only) - Bundle must exist before importing media - Track extensions (‚Äúegg‚Äù, ‚Äúflow‚Äù) must be defined in database config - Requires <code>wrassp</code> package for audio file handling</p>
</div>
</div>
<div class="section level3">
<h3 id="id_5-enhanced-summary-method">5. Enhanced Summary Method<a class="anchor" aria-label="anchor" href="#id_5-enhanced-summary-method"></a></h3>
<p>The <code>summary(corpus)</code> method now provides comprehensive information matching emuR‚Äôs output:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">VISP</span><span class="op">)</span></span></code></pre></div>
<p><strong>Displays</strong>: - Database name, UUID, path - Session, bundle, item, label, and link counts - SSFF track definitions - Level definitions with attributes - Link definitions (hierarchy) - Metadata diagnostics (fields, types, coverage)</p>
</div>
<div class="section level3">
<h3 id="id_6-metadata-management-system-rreindeer_metadata_optimizedr">6. Metadata Management System (<code>R/reindeeR_metadata_optimized.R</code>)<a class="anchor" aria-label="anchor" href="#id_6-metadata-management-system-rreindeer_metadata_optimizedr"></a></h3>
<div class="section level4">
<h4 id="sqlite-schema-for-metadata-caching">SQLite Schema for Metadata Caching<a class="anchor" aria-label="anchor" href="#sqlite-schema-for-metadata-caching"></a></h4>
<ul><li>
<code>metadata_fields</code>: Tracks all known metadata fields and types</li>
<li>
<code>metadata_database</code>: Database-level defaults</li>
<li>
<code>metadata_session</code>: Session-level defaults</li>
<li>
<code>metadata_bundle</code>: Bundle-specific metadata</li>
</ul></div>
<div class="section level4">
<h4 id="metadata-inheritance">Metadata Inheritance<a class="anchor" aria-label="anchor" href="#metadata-inheritance"></a></h4>
<p>Metadata follows precedence: <strong>Bundle &gt; Session &gt; Database</strong></p>
</div>
<div class="section level4">
<h4 id="ground-truth-meta_json-files">Ground Truth: <code>.meta_json</code> Files<a class="anchor" aria-label="anchor" href="#ground-truth-meta_json-files"></a></h4>
<ul><li>Database: <code>&lt;dbname&gt;.meta_json</code> in database root</li>
<li>Session: <code>&lt;sessionname&gt;.meta_json</code> in session directory</li>
<li>Bundle: <code>&lt;bundlename&gt;.meta_json</code> in bundle directory</li>
</ul><p>All modifications update both the <code>.meta_json</code> files (ground truth) and the SQLite cache.</p>
</div>
<div class="section level4">
<h4 id="internal-functions">Internal Functions<a class="anchor" aria-label="anchor" href="#internal-functions"></a></h4>
<ul><li>
<code><a href="reference/gather_metadata_internal.html">gather_metadata_internal()</a></code>: Scans all <code>.meta_json</code> files during corpus construction</li>
<li>
<code><a href="reference/process_metadata_list.html">process_metadata_list()</a></code>: Inserts metadata into appropriate cache tables</li>
<li>
<code><a href="reference/serialize_metadata_value.html">serialize_metadata_value()</a></code> / <code><a href="reference/deserialize_metadata_value.html">deserialize_metadata_value()</a></code>: Handle type conversion</li>
<li>
<code><a href="reference/register_metadata_field.html">register_metadata_field()</a></code>: Tracks metadata fields and types</li>
</ul></div>
</div>
<div class="section level3">
<h3 id="id_7-helper-functions-rreindeer-corpusr">7. Helper Functions (<code>R/reindeer-corpus.R</code>)<a class="anchor" aria-label="anchor" href="#id_7-helper-functions-rreindeer-corpusr"></a></h3>
<ul><li>
<code><a href="reference/get_corpus_connection.html">get_corpus_connection()</a></code>: Gets SQLite connection to cache file</li>
<li>
<code><a href="reference/get_metadata_for_patterns.html">get_metadata_for_patterns()</a></code>: Retrieves metadata for bundles matching regex patterns</li>
<li>
<code><a href="reference/get_metadata_field_values.html">get_metadata_field_values()</a></code>: Gets values for a single field with inheritance</li>
<li>
<code><a href="reference/corpus_assign_metadata.html">corpus_assign_metadata()</a></code>: Routes metadata assignment to appropriate level</li>
<li>
<code>set_metadata_database/session/bundle()</code>: Writes metadata at each level</li>
<li>
<code><a href="reference/corpus_import_media.html">corpus_import_media()</a></code>: Handles media file import with channel mapping</li>
<li>
<code><a href="reference/import_media_to_bundle.html">import_media_to_bundle()</a></code>: Performs actual media import using wrassp</li>
</ul></div>
<div class="section level3">
<h3 id="id_8-configuration-loading-rreindeer_corpus_configr">8. Configuration Loading (<code>R/reindeer_corpus_config.R</code>)<a class="anchor" aria-label="anchor" href="#id_8-configuration-loading-rreindeer_corpus_configr"></a></h3>
<p>Modified <code><a href="reference/load_DBconfig.html">load_DBconfig()</a></code> to handle multiple input types: - Character (basePath) - Corpus objects - emuDBhandle objects</p>
<p>Uses polymorphism instead of S7 dispatch to avoid loading order issues.</p>
</div>
</div>
<div class="section level2">
<h2 id="database-metadata-storage-meta_json-location">Database Metadata Storage (<code>.meta_json</code> Location)<a class="anchor" aria-label="anchor" href="#database-metadata-storage-meta_json-location"></a></h2>
<p><strong>Changed from DBconfig to separate file</strong>: - OLD: Database defaults stored in <code>metadataDefaults</code> field of <code>_DBconfig.json</code><br>
- NEW: Database defaults stored in <code>&lt;dbname&gt;.meta_json</code> in database root directory</p>
<p>This change improves compatibility with other EMU tools that may not recognize custom DBconfig fields.</p>
</div>
<div class="section level2">
<h2 id="integration-status">Integration Status<a class="anchor" aria-label="anchor" href="#integration-status"></a></h2>
<div class="section level3">
<h3 id="completed">Completed<a class="anchor" aria-label="anchor" href="#completed"></a></h3>
<p>‚úÖ Corpus S7 class definition with all properties<br>
‚úÖ Bundle_list S7 class<br>
‚úÖ Subsetting operators <code>[</code> and <code>[&lt;-</code><br>
‚úÖ Metadata reading with inheritance<br>
‚úÖ Metadata writing to .meta_json files<br>
‚úÖ SQLite metadata caching schema<br>
‚úÖ Enhanced summary() method<br>
‚úÖ Media import infrastructure<br>
‚úÖ Multi-channel audio handling<br>
‚úÖ Helper functions for all operations</p>
</div>
<div class="section level3">
<h3 id="testing-required">Testing Required<a class="anchor" aria-label="anchor" href="#testing-required"></a></h3>
<p>‚ö†Ô∏è Full integration testing with real database<br>
‚ö†Ô∏è Regex pattern matching for sessions/bundles<br>
‚ö†Ô∏è Media import with various audio formats<br>
‚ö†Ô∏è Metadata type validation and conversion<br>
‚ö†Ô∏è Interaction with emuR::query() results</p>
</div>
<div class="section level3">
<h3 id="known-issues">Known Issues<a class="anchor" aria-label="anchor" href="#known-issues"></a></h3>
<p>üîß Package loading order: There are function name conflicts during <code><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">devtools::load_all()</a></code> suggesting some files may be sourced rather than properly loaded. This needs investigation to ensure clean package loading.</p>
</div>
</div>
<div class="section level2">
<h2 id="usage-examples">Usage Examples<a class="anchor" aria-label="anchor" href="#usage-examples"></a></h2>
<div class="section level3">
<h3 id="complete-workflow">Complete Workflow<a class="anchor" aria-label="anchor" href="#complete-workflow"></a></h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">reindeer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create or load corpus</span></span>
<span><span class="va">VISP</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/corpus.html">corpus</a></span><span class="op">(</span><span class="st">"path/to/ae_emuDB"</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View corpus info</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">VISP</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">VISP</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get bundles with metadata</span></span>
<span><span class="va">all_bundles</span> <span class="op">&lt;-</span> <span class="va">VISP</span><span class="op">[</span>, <span class="op">]</span>  <span class="co"># All bundles</span></span>
<span><span class="va">session1_bundles</span> <span class="op">&lt;-</span> <span class="va">VISP</span><span class="op">[</span><span class="st">"0000"</span>, <span class="op">]</span>  <span class="co"># All in session "0000"</span></span>
<span><span class="va">specific_bundle</span> <span class="op">&lt;-</span> <span class="va">VISP</span><span class="op">[</span><span class="st">"0000"</span>, <span class="st">"msajc003"</span><span class="op">]</span>  <span class="co"># Specific bundle</span></span>
<span></span>
<span><span class="co"># Set database-wide defaults</span></span>
<span><span class="va">VISP</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Institution <span class="op">=</span> <span class="st">"LMU"</span>, Project <span class="op">=</span> <span class="st">"AE-Study"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set session metadata</span></span>
<span><span class="va">VISP</span><span class="op">[</span><span class="st">"0000"</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Speaker <span class="op">=</span> <span class="st">"AE01"</span>, Age <span class="op">=</span> <span class="fl">32</span>, Gender <span class="op">=</span> <span class="st">"Female"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set bundle-specific metadata</span></span>
<span><span class="va">VISP</span><span class="op">[</span><span class="st">"0000"</span>, <span class="st">"msajc003"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Condition <span class="op">=</span> <span class="st">"Read"</span>, Quality <span class="op">=</span> <span class="st">"Good"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Import media</span></span>
<span><span class="va">VISP</span><span class="op">[</span><span class="st">"0000"</span>, <span class="st">"msajc003"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"recordings/msajc003.wav"</span></span>
<span></span>
<span><span class="co"># Import multi-channel with EGG</span></span>
<span><span class="va">VISP</span><span class="op">[</span><span class="st">"0000"</span>, <span class="st">"msajc003"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"recordings/msajc003_multi.wav"</span>, <span class="st">"egg"</span>, <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check metadata was applied</span></span>
<span><span class="va">bundle_info</span> <span class="op">&lt;-</span> <span class="va">VISP</span><span class="op">[</span><span class="st">"0000"</span>, <span class="st">"msajc003"</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bundle_info</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="working-with-query-results">Working with Query Results<a class="anchor" aria-label="anchor" href="#working-with-query-results"></a></h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform query</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">query_opt</span><span class="op">(</span><span class="va">VISP</span>, <span class="st">"Phonetic == t"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add metadata to results (biographize)</span></span>
<span><span class="va">result_with_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/biographize.html">biographize</a></span><span class="op">(</span><span class="va">result</span>, <span class="va">VISP</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now has speaker info, age, gender, etc.</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="file-structure">File Structure<a class="anchor" aria-label="anchor" href="#file-structure"></a></h2>
<pre><code>R/
‚îú‚îÄ‚îÄ reindeer-corpus.R              # Main corpus class &amp; operators
‚îú‚îÄ‚îÄ reindeeR_metadata_optimized.R  # Metadata management system
‚îú‚îÄ‚îÄ reindeer_corpus_config.R       # Config loading (modified)
‚îî‚îÄ‚îÄ reindeeR_database.R            # Media import reference

Database Structure:
database_emuDB/
‚îú‚îÄ‚îÄ database.meta_json             # Database-level defaults (NEW)
‚îú‚îÄ‚îÄ database_DBconfig.json         # Database configuration
‚îú‚îÄ‚îÄ database_emuDBcache.sqlite     # SQLite cache (with metadata tables)
‚îú‚îÄ‚îÄ Session1_ses/
‚îÇ   ‚îú‚îÄ‚îÄ Session1.meta_json         # Session-level metadata
‚îÇ   ‚îú‚îÄ‚îÄ Bundle1_bndl/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Bundle1.meta_json      # Bundle-level metadata
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Bundle1_annot.json     # Annotations
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Bundle1.wav            # Media file
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Bundle1.egg            # Additional track (if present)
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ ...</code></pre>
</div>
<div class="section level2">
<h2 id="performance-considerations">Performance Considerations<a class="anchor" aria-label="anchor" href="#performance-considerations"></a></h2>
<ul><li>
<strong>Metadata caching</strong>: Metadata is cached in SQLite for fast access</li>
<li>
<strong>Lazy loading</strong>: Corpus connection is established on-demand</li>
<li>
<strong>Batch operations</strong>: Metadata writes are transaction-protected</li>
<li>
<strong>Regex matching</strong>: Pattern-based operations scan in-memory then query cache</li>
</ul></div>
<div class="section level2">
<h2 id="future-enhancements">Future Enhancements<a class="anchor" aria-label="anchor" href="#future-enhancements"></a></h2>
<ol style="list-style-type: decimal"><li>
<strong>Validation</strong>: Add metadata field validation against schema</li>
<li>
<strong>Export/Import</strong>: Excel export/import for bulk metadata editing (partially implemented)</li>
<li>
<strong>Type coercion</strong>: Automatic type conversion with user confirmation</li>
<li>
<strong>Field discovery</strong>: Suggest similar field names when typos detected</li>
<li>
<strong>Batch import</strong>: Import media for multiple bundles at once</li>
<li>
<strong>Track management</strong>: List and validate track definitions before import</li>
</ol></div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a></h2>
<ul><li>S7: For class definitions</li>
<li>DBI/RSQLite: For cache management</li>
<li>jsonlite: For .meta_json file handling</li>
<li>wrassp: For audio file import</li>
<li>cli: For user interface</li>
<li>stringr, dplyr, tibble: For data manipulation</li>
</ul></div>
<div class="section level2">
<h2 id="testing-recommendations">Testing Recommendations<a class="anchor" aria-label="anchor" href="#testing-recommendations"></a></h2>
<ol style="list-style-type: decimal"><li>Create test database with multiple sessions and bundles</li>
<li>Test metadata inheritance at each level</li>
<li>Test regex patterns for session/bundle matching</li>
<li>Test media import with various formats</li>
<li>Test interaction with query results</li>
<li>Test Excel export/import workflow</li>
<li>Verify <code>.meta_json</code> files are correctly written</li>
<li>Verify SQLite cache stays synchronized</li>
</ol></div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a></h2>
<p>All exported functions have roxygen documentation. Key user-facing documentation: - <code><a href="reference/corpus.html">?corpus</a></code>: Corpus class construction and usage - <code><a href="reference/bundle_list.html">?bundle_list</a></code>: Bundle list class - <code><a href="reference/summary.corpus.html">?summary.corpus</a></code>: Enhanced summary method - Export/import functions in <code>reindeeR_metadata_optimized.R</code></p>
<hr><p><strong>Date</strong>: 2025-10-14<br><strong>Author</strong>: Implementation based on user requirements for enhanced metadata and media management in reindeer package</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/frkkan96" class="external-link">Fredrik Karlsson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

