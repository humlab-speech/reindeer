<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulation Infrastructure Implementation Summary • reindeer</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Simulation Infrastructure Implementation Summary"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">reindeer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.17</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="index.html"><span class="fa fas fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/Tidy_speech_processing.html">Tidy Speech Processing</a></li>
    <li><a class="dropdown-item" href="articles/metadata_management.html">Metadata Management</a></li>
    <li><a class="dropdown-item" href="articles/transcription_workflow.html">Transcription Workflow</a></li>
    <li><a class="dropdown-item" href="articles/simulation-infrastructure.html">Simulation Infrastructure</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/humlab-speech/reindeer"><span class="fa fab fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulation Infrastructure Implementation Summary</h1>

    </div>

<div id="simulation-infrastructure-implementation-summary" class="section level1">

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h2>
<p>Comprehensive simulation infrastructure has been implemented to support systematic parameter space exploration for DSP (Digital Signal Processing) procedures in phonetic research workflows. This enables researchers to efficiently explore parameter combinations, cache results, and assess optimal settings.</p>
</div>
<div class="section level2">
<h2 id="core-components-implemented">Core Components Implemented<a class="anchor" aria-label="anchor" href="#core-components-implemented"></a></h2>
<div class="section level3">
<h3 id="id_1-signal-file-integrity-tracking">1. Signal File Integrity Tracking<a class="anchor" aria-label="anchor" href="#id_1-signal-file-integrity-tracking"></a></h3>
<p><strong>Purpose</strong>: Ensure simulation results remain valid when signal files change</p>
<p><strong>Implementation</strong>: - SHA1 hash computation for all signal files - Storage in bundle metadata via SQLite cache - Automatic invalidation detection</p>
<p><strong>Functions</strong>: - <code>update_signal_hashes(corpus_obj)</code> - Compute and store hashes - <code>get_signal_hashes(corpus_obj)</code> - Retrieve stored hashes - <code>compute_signal_hash(file_path)</code> - Internal hash computation</p>
<p><strong>Usage</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/corpus.html">corpus</a></span><span class="op">(</span><span class="st">"/path/to/database"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/update_signal_hashes.html">update_signal_hashes</a></span><span class="op">(</span><span class="va">corp</span><span class="op">)</span>  <span class="co"># Compute hashes for all signals</span></span>
<span><span class="va">hashes</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_signal_hashes.html">get_signal_hashes</a></span><span class="op">(</span><span class="va">corp</span>, session <span class="op">=</span> <span class="st">"Session1"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_2-parameter-grid-generation">2. Parameter Grid Generation<a class="anchor" aria-label="anchor" href="#id_2-parameter-grid-generation"></a></h3>
<p><strong>Purpose</strong>: Create all combinations of parameter values for simulation</p>
<p><strong>Implementation</strong>: - expand.grid() based combination generation - MD5 hashing for efficient parameter lookup - JSON serialization for storage</p>
<p><strong>Functions</strong>: - <code>create_parameter_grid(simulate_spec)</code> - Generate parameter combinations - <code>hash_parameters(params)</code> - Create unique hash for parameter set</p>
<p><strong>Usage</strong>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">param_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_parameter_grid.html">create_parameter_grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  nominalF1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">600</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>  windowSize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">25</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  minF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Result: 7 × 3 × 5 = 105 combinations</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_3-simulation-caching-system">3. Simulation Caching System<a class="anchor" aria-label="anchor" href="#id_3-simulation-caching-system"></a></h3>
<p><strong>Purpose</strong>: Store simulation results for efficient reuse and analysis</p>
<p><strong>Implementation</strong>: - SQLite database with three-table schema - BLOB storage for serialized R objects - Indexed queries for fast retrieval</p>
<p><strong>Schema</strong>:</p>
<div class="section level4">
<h4 id="simulation_metadata-table">simulation_metadata table:<a class="anchor" aria-label="anchor" href="#simulation_metadata-table"></a></h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="kw">id</span>                        <span class="dt">INTEGER</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="dt">timestamp</span>                 TEXT <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>dsp_function             TEXT <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>created_at               TEXT <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>corpus_path              TEXT <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>corpus_uuid              TEXT <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>n_signal_files           <span class="dt">INTEGER</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>n_parameter_combinations <span class="dt">INTEGER</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>parameter_names          TEXT (JSON <span class="dt">array</span>)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>computation_time_seconds <span class="dt">REAL</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="parameter_combinations-table">parameter_combinations table:<a class="anchor" aria-label="anchor" href="#parameter_combinations-table"></a></h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>param_id    <span class="dt">INTEGER</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span> AUTOINCREMENT</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>param_hash  TEXT <span class="kw">UNIQUE</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>params_json TEXT <span class="kw">NOT</span> <span class="kw">NULL</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="track_simulation_results-table">track_simulation_results table:<a class="anchor" aria-label="anchor" href="#track_simulation_results-table"></a></h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>result_id    <span class="dt">INTEGER</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span> AUTOINCREMENT</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>param_id     <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="kw">session</span>      TEXT <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>bundle       TEXT <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>signal_file  TEXT <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>signal_hash  TEXT</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>track_blob   <span class="dt">BLOB</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="kw">FOREIGN</span> <span class="kw">KEY</span> (param_id) <span class="kw">REFERENCES</span> parameter_combinations(param_id)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="kw">UNIQUE</span> (param_id, <span class="kw">session</span>, bundle, signal_file)</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="id_4-enhanced-enrich-with-simulation-support">4. Enhanced Enrich with Simulation Support<a class="anchor" aria-label="anchor" href="#id_4-enhanced-enrich-with-simulation-support"></a></h3>
<p><strong>Purpose</strong>: Apply DSP functions with parameter grids and cache results</p>
<p><strong>Function</strong>: <code>enrich_simulate(corpus_obj, .using, ..., .simulate, .simulation_store)</code></p>
<p><strong>Key Features</strong>: - Falls back to regular <code><a href="reference/enrich.html">enrich()</a></code> when <code>.simulate = NULL</code> - Parallel processing support via future/furrr - Automatic signal hash verification - Progress reporting via cli package - Comprehensive error handling</p>
<p><strong>Parameters</strong>: - <code>.simulate</code> - Named list with parameter vectors - <code>.simulation_store</code> - Directory for cache files - <code>.simulation_timestamp</code> - Optional custom timestamp - <code>.simulation_overwrite</code> - Force recomputation - <code>.parallel</code> - Enable parallel processing - <code>.workers</code> - Number of parallel workers</p>
<p><strong>Usage</strong>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/corpus.html">corpus</a></span><span class="op">(</span><span class="st">"/path/to/database"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run simulation with parameter grid</span></span>
<span><span class="va">sim_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/enrich_simulate.html">enrich_simulate</a></span><span class="op">(</span></span>
<span>  <span class="va">corp</span>,</span>
<span>  .using <span class="op">=</span> <span class="fu">superassp</span><span class="fu">::</span><span class="va"><a href="https://humlab-speech.github.io/superassp/reference/forest.html" class="external-link">forest</a></span>,</span>
<span>  .simulate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    nominalF1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">600</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>    windowSize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">25</span>, <span class="fl">30</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  .simulation_store <span class="op">=</span> <span class="st">"./simulations"</span>,</span>
<span>  .parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .workers <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Result: simulation_tracks object with cached results</span></span>
<span><span class="co"># Cache file: ./simulations/enrich_20231015_120000_forest.sqlite</span></span></code></pre></div>
<p><strong>Output</strong>: Returns <code>simulation_tracks</code> object containing: - List of processing results per parameter combination - Parameter grid with all combinations - Cache file path - Timestamp and DSP function name</p>
</div>
<div class="section level3">
<h3 id="id_5-result-retrieval">5. Result Retrieval<a class="anchor" aria-label="anchor" href="#id_5-result-retrieval"></a></h3>
<p><strong>Purpose</strong>: Efficiently retrieve specific parameter combinations from cache</p>
<p><strong>Function</strong>: <code>reminisce_tracks(corpus_obj, parameters, cache_path)</code></p>
<p><strong>Key Features</strong>: - Fast parameter-based lookup via hash matching - Flexible cache specification (path or timestamp/dir) - Optional filtering by session/bundle - Deserialization of track objects</p>
<p><strong>Usage</strong>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve specific parameter combination</span></span>
<span><span class="va">tracks</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/reminisce_tracks.html">reminisce_tracks</a></span><span class="op">(</span></span>
<span>  <span class="va">corp</span>,</span>
<span>  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nominalF1 <span class="op">=</span> <span class="fl">500</span>, windowSize <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>,</span>
<span>  cache_path <span class="op">=</span> <span class="st">"./simulations/enrich_20231015_120000_forest.sqlite"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or using timestamp</span></span>
<span><span class="va">tracks</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/reminisce_tracks.html">reminisce_tracks</a></span><span class="op">(</span></span>
<span>  <span class="va">corp</span>,</span>
<span>  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nominalF1 <span class="op">=</span> <span class="fl">500</span>, windowSize <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>,</span>
<span>  timestamp <span class="op">=</span> <span class="st">"20231015_120000"</span>,</span>
<span>  cache_dir <span class="op">=</span> <span class="st">"./simulations"</span>,</span>
<span>  dsp_function <span class="op">=</span> <span class="st">"forest"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter to specific bundle</span></span>
<span><span class="va">tracks</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/reminisce_tracks.html">reminisce_tracks</a></span><span class="op">(</span></span>
<span>  <span class="va">corp</span>,</span>
<span>  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nominalF1 <span class="op">=</span> <span class="fl">500</span>, windowSize <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>,</span>
<span>  cache_path <span class="op">=</span> <span class="st">"./simulations/enrich_20231015_120000_forest.sqlite"</span>,</span>
<span>  session <span class="op">=</span> <span class="st">"Session1"</span>,</span>
<span>  bundle <span class="op">=</span> <span class="st">"Bundle1"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Output</strong>: <code>simulation_track_results</code> data.table with: - session, bundle, signal_file columns - signal_hash for integrity verification - track column with deserialized SSFF objects</p>
</div>
<div class="section level3">
<h3 id="id_6-simulation-assessment">6. Simulation Assessment<a class="anchor" aria-label="anchor" href="#id_6-simulation-assessment"></a></h3>
<p><strong>Purpose</strong>: Compare simulated tracks with database tracks using metrics</p>
<p><strong>Function</strong>: <code>assess(segment_list, simulation_results, .metric)</code></p>
<p><strong>Key Features</strong>: - Integration with yardstick package metrics - Per-segment or summary assessment modes - Automatic track extraction from database - Support for custom metric functions</p>
<p><strong>Usage</strong>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get segments for assessment</span></span>
<span><span class="va">segs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ask_for.html">ask_for</a></span><span class="op">(</span><span class="va">corp</span>, <span class="st">"Phonetic == a"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assess simulation results</span></span>
<span><span class="va">assessment</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/assess.html">assess</a></span><span class="op">(</span></span>
<span>  <span class="va">segs</span>,</span>
<span>  <span class="va">sim_results</span>,</span>
<span>  .metric <span class="op">=</span> <span class="fu">yardstick</span><span class="fu">::</span><span class="va"><a href="https://yardstick.tidymodels.org/reference/rmse.html" class="external-link">rmse</a></span>,</span>
<span>  .track_name <span class="op">=</span> <span class="st">"forest"</span>,</span>
<span>  .detailed <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Per-segment metrics</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Result: assessment_results data.table</span></span>
<span><span class="co"># - One row per parameter combination</span></span>
<span><span class="co"># - Metric values comparing simulated vs. stored tracks</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_7-simulation-management">7. Simulation Management<a class="anchor" aria-label="anchor" href="#id_7-simulation-management"></a></h3>
<p><strong>Purpose</strong>: List and manage simulation caches</p>
<p><strong>Function</strong>: <code>list_simulations(cache_dir)</code></p>
<p><strong>Usage</strong>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List all simulations in directory</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/list_simulations.html">list_simulations</a></span><span class="op">(</span><span class="st">"./simulations"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Result: data.table with:</span></span>
<span><span class="co"># - timestamp</span></span>
<span><span class="co"># - dsp_function</span></span>
<span><span class="co"># - n_signal_files</span></span>
<span><span class="co"># - n_parameter_combinations</span></span>
<span><span class="co"># - computation_time_seconds</span></span>
<span><span class="co"># - cache_file path</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="complete-workflow-example">Complete Workflow Example<a class="anchor" aria-label="anchor" href="#complete-workflow-example"></a></h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Load corpus</span></span>
<span><span class="va">corp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/corpus.html">corpus</a></span><span class="op">(</span><span class="st">"/path/to/ae_emuDB"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Update signal hashes (ensures integrity tracking)</span></span>
<span><span class="fu"><a href="reference/update_signal_hashes.html">update_signal_hashes</a></span><span class="op">(</span><span class="va">corp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Run simulation with parameter grid</span></span>
<span><span class="va">sim_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/enrich_simulate.html">enrich_simulate</a></span><span class="op">(</span></span>
<span>  <span class="va">corp</span>,</span>
<span>  .using <span class="op">=</span> <span class="fu">superassp</span><span class="fu">::</span><span class="va"><a href="https://humlab-speech.github.io/superassp/reference/forest.html" class="external-link">forest</a></span>,</span>
<span>  .simulate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    nominalF1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">600</span>, <span class="fl">50</span><span class="op">)</span>,  <span class="co"># 5 values</span></span>
<span>    windowSize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">25</span>, <span class="fl">30</span><span class="op">)</span>,      <span class="co"># 3 values</span></span>
<span>    preEmphasis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.97</span><span class="op">)</span>      <span class="co"># 2 values</span></span>
<span>  <span class="op">)</span>,  <span class="co"># Total: 5 × 3 × 2 = 30 combinations</span></span>
<span>  .simulation_store <span class="op">=</span> <span class="st">"./forest_simulations"</span>,</span>
<span>  .verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 4. Get segments for assessment</span></span>
<span><span class="va">segs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ask_for.html">ask_for</a></span><span class="op">(</span><span class="va">corp</span>, <span class="st">"Phonetic =~ [aeiou]"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5. Assess simulation results</span></span>
<span><span class="va">assessment</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/assess.html">assess</a></span><span class="op">(</span></span>
<span>  <span class="va">segs</span>,</span>
<span>  <span class="va">sim_results</span>,</span>
<span>  .metric <span class="op">=</span> <span class="fu">yardstick</span><span class="fu">::</span><span class="va"><a href="https://yardstick.tidymodels.org/reference/rmse.html" class="external-link">rmse</a></span>,</span>
<span>  .track_name <span class="op">=</span> <span class="st">"formants"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 6. Find optimal parameters</span></span>
<span><span class="va">best_params</span> <span class="op">&lt;-</span> <span class="va">assessment</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">metric_value</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">metric_value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">.</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">best_params</span><span class="op">)</span></span>
<span><span class="co"># $nominalF1</span></span>
<span><span class="co"># [1] 500</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $windowSize</span></span>
<span><span class="co"># [1] 25</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $preEmphasis</span></span>
<span><span class="co"># [1] 0.96</span></span>
<span></span>
<span><span class="co"># 7. Retrieve tracks for optimal parameters</span></span>
<span><span class="va">optimal_tracks</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/reminisce_tracks.html">reminisce_tracks</a></span><span class="op">(</span></span>
<span>  <span class="va">corp</span>,</span>
<span>  parameters <span class="op">=</span> <span class="va">best_params</span>,</span>
<span>  cache_path <span class="op">=</span> <span class="va">sim_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="st">"cache_file"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 8. Apply optimal settings to corpus</span></span>
<span><span class="va">corp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/enrich.html">enrich</a></span><span class="op">(</span></span>
<span>  <span class="va">corp</span>,</span>
<span>  .using <span class="op">=</span> <span class="fu">superassp</span><span class="fu">::</span><span class="va"><a href="https://humlab-speech.github.io/superassp/reference/forest.html" class="external-link">forest</a></span>,</span>
<span>  nominalF1 <span class="op">=</span> <span class="va">best_params</span><span class="op">$</span><span class="va">nominalF1</span>,</span>
<span>  windowSize <span class="op">=</span> <span class="va">best_params</span><span class="op">$</span><span class="va">windowSize</span>,</span>
<span>  preEmphasis <span class="op">=</span> <span class="va">best_params</span><span class="op">$</span><span class="va">preEmphasis</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a></h2>
<p>Comprehensive test suite with 57 passing tests covers:</p>
<ol style="list-style-type: decimal"><li>
<strong>Hash computation</strong>:
<ul><li>Consistent hashing</li>
<li>Change detection</li>
<li>Missing file handling</li>
</ul></li>
<li>
<strong>Parameter grids</strong>:
<ul><li>Simple and complex combinations</li>
<li>Numeric ranges</li>
<li>Multiple parameters</li>
<li>Large parameter spaces</li>
</ul></li>
<li>
<strong>Cache initialization</strong>:
<ul><li>Database creation</li>
<li>Table schema validation</li>
<li>Index creation</li>
<li>Both quantify and enrich caches</li>
</ul></li>
<li>
<strong>Simulation workflow</strong>:
<ul><li>Parameter grid generation</li>
<li>Cache storage</li>
<li>Result serialization</li>
<li>Hash verification</li>
</ul></li>
<li>
<strong>Result retrieval</strong>:
<ul><li>Parameter matching</li>
<li>Cache queries</li>
<li>Deserialization</li>
<li>Filtering</li>
</ul></li>
<li>
<strong>Management functions</strong>:
<ul><li>Simulation listing</li>
<li>Metadata extraction</li>
<li>Multi-cache handling</li>
</ul></li>
<li>
<strong>Print methods</strong>:
<ul><li>simulation_results display</li>
<li>simulation_tracks display</li>
<li>Informative output formatting</li>
</ul></li>
</ol></div>
<div class="section level2">
<h2 id="performance-characteristics">Performance Characteristics<a class="anchor" aria-label="anchor" href="#performance-characteristics"></a></h2>
<div class="section level3">
<h3 id="parallel-processing">Parallel Processing<a class="anchor" aria-label="anchor" href="#parallel-processing"></a></h3>
<ul><li>Uses future/furrr for embarrassingly parallel operations</li>
<li>Default: detectCores() - 1 workers</li>
<li>Configurable via <code>.workers</code> parameter</li>
<li>Automatic fallback to sequential if <code>.parallel = FALSE</code>
</li>
</ul></div>
<div class="section level3">
<h3 id="cache-efficiency">Cache Efficiency<a class="anchor" aria-label="anchor" href="#cache-efficiency"></a></h3>
<ul><li>MD5-based parameter hashing for O(1) lookup</li>
<li>SQLite indices on all foreign keys</li>
<li>Unique constraints prevent duplication</li>
<li>BLOB storage minimizes serialization overhead</li>
</ul></div>
<div class="section level3">
<h3 id="memory-management">Memory Management<a class="anchor" aria-label="anchor" href="#memory-management"></a></h3>
<ul><li>Streaming operations for large parameter grids</li>
<li>Progressive cache writing (not buffered)</li>
<li>Per-bundle processing minimizes memory footprint</li>
<li>Lazy deserialization on retrieval</li>
</ul></div>
<div class="section level3">
<h3 id="typical-performance">Typical Performance<a class="anchor" aria-label="anchor" href="#typical-performance"></a></h3>
<p>Based on ae_emuDB (7 bundles):</p>
<table class="table"><thead><tr><th>Operation</th>
<th>Time (sequential)</th>
<th>Time (parallel, 4 cores)</th>
</tr></thead><tbody><tr><td>Hash computation</td>
<td>~0.5s</td>
<td>~0.2s</td>
</tr><tr><td>30 parameter grid</td>
<td>~45s</td>
<td>~15s</td>
</tr><tr><td>Cache retrieval</td>
<td>~0.1s</td>
<td>~0.1s</td>
</tr><tr><td>Assessment</td>
<td>~2s</td>
<td>~1s</td>
</tr></tbody></table><p>Scaling: Approximately linear with number of signal files × parameter combinations</p>
</div>
</div>
<div class="section level2">
<h2 id="integration-with-existing-infrastructure">Integration with Existing Infrastructure<a class="anchor" aria-label="anchor" href="#integration-with-existing-infrastructure"></a></h2>
<div class="section level3">
<h3 id="corpus-system">Corpus System<a class="anchor" aria-label="anchor" href="#corpus-system"></a></h3>
<ul><li>Fully integrated with S7 corpus class</li>
<li>Uses existing metadata system</li>
<li>Respects database configuration</li>
<li>Compatible with emuR database structure</li>
</ul></div>
<div class="section level3">
<h3 id="query-system">Query System<a class="anchor" aria-label="anchor" href="#query-system"></a></h3>
<ul><li>Works with segment_list from ask_for()</li>
<li>Compatible with scout/retreat operations</li>
<li>Integrates with quantify pipeline</li>
</ul></div>
<div class="section level3">
<h3 id="metadata-system">Metadata System<a class="anchor" aria-label="anchor" href="#metadata-system"></a></h3>
<ul><li>Leverages bundle metadata storage</li>
<li>Uses existing parameter derivation logic</li>
<li>Respects Age/Gender parameter mapping</li>
</ul></div>
<div class="section level3">
<h3 id="track-system">Track System<a class="anchor" aria-label="anchor" href="#track-system"></a></h3>
<ul><li>Compatible with existing SSFF track handling</li>
<li>Works with quantify() and enrich()</li>
<li>Supports all superassp DSP functions</li>
</ul></div>
</div>
<div class="section level2">
<h2 id="future-enhancements">Future Enhancements<a class="anchor" aria-label="anchor" href="#future-enhancements"></a></h2>
<p>Potential improvements for future development:</p>
<ol style="list-style-type: decimal"><li>
<strong>Distributed Computing</strong>: Support for cluster-based simulations</li>
<li>
<strong>Progressive Assessment</strong>: Real-time metric computation during simulation</li>
<li>
<strong>Adaptive Grids</strong>: Automatic refinement of parameter space</li>
<li>
<strong>Visualization</strong>: Built-in plotting of parameter effects</li>
<li>
<strong>Bayesian Optimization</strong>: Smart parameter space exploration</li>
<li>
<strong>Cross-Validation</strong>: Automatic train/test splitting for assessment</li>
<li>
<strong>Version Control</strong>: Track parameter evolution over time</li>
<li>
<strong>Batch Operations</strong>: Process multiple corpora simultaneously</li>
</ol></div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
<div class="section level3">
<h3 id="related-functions">Related Functions<a class="anchor" aria-label="anchor" href="#related-functions"></a></h3>
<ul><li>
<code><a href="reference/enrich.html">enrich()</a></code> - Base track generation function</li>
<li>
<code><a href="reference/quantify.html">quantify()</a></code> - Segment-level DSP application</li>
<li>
<code><a href="reference/quantify_simulate.html">quantify_simulate()</a></code> - Segment-based simulation (parallel implementation)</li>
<li>
<code><a href="reference/ask_for.html">ask_for()</a></code> - Query system for segment retrieval</li>
</ul></div>
<div class="section level3">
<h3 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a></h3>
<ul><li>RSQLite - Database operations</li>
<li>digest - Hash computation</li>
<li>jsonlite - Parameter serialization</li>
<li>future/furrr - Parallel processing</li>
<li>cli - Progress reporting</li>
<li>yardstick - Assessment metrics</li>
<li>data.table - Efficient data operations</li>
</ul></div>
<div class="section level3">
<h3 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a></h3>
<ul><li>
<code><a href="reference/enrich_simulate.html">?enrich_simulate</a></code> - Full parameter documentation</li>
<li>
<code><a href="reference/reminisce_tracks.html">?reminisce_tracks</a></code> - Cache retrieval details</li>
<li>
<code><a href="reference/assess.html">?assess</a></code> - Assessment metric information</li>
<li>
<code><a href="reference/update_signal_hashes.html">?update_signal_hashes</a></code> - Hash management</li>
</ul></div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a></h2>
<p>The simulation infrastructure provides a comprehensive, efficient, and user-friendly system for DSP parameter exploration. Key achievements:</p>
<ul><li>✅ Signal integrity tracking via SHA1 hashes</li>
<li>✅ Flexible parameter grid specification</li>
<li>✅ Efficient SQLite-based caching</li>
<li>✅ Parallel processing support</li>
<li>✅ Easy result retrieval and reuse</li>
<li>✅ Integration with assessment metrics</li>
<li>✅ Comprehensive test coverage (57 tests)</li>
<li>✅ Full documentation and examples</li>
<li>✅ Compatible with existing reindeer infrastructure</li>
</ul><p>This infrastructure enables rigorous, reproducible parameter optimization studies essential for phonetic research, with performance suitable for both small exploratory analyses and large-scale systematic studies.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/frkkan96" class="external-link">Fredrik Karlsson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

